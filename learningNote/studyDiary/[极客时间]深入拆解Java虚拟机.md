### Java代码是怎么运行的？
    Java 虚拟机具体是怎样运行 Java 字节码的？
从虚拟机以及底层硬件两个角度，给你讲一讲
从虚拟机视角来看，执行 Java 代码首先需要将它编译而成的 class 文件加载到 Java 虚拟机中。加
载后的 Java 类会被存放于方法区（Method Area）中。实际运行时，虚拟机会执行方法区内的代
码。
![](http://ww1.sinaimg.cn/large/b06adeeegy1g0jne8gsbwj20fc0aujs7.jpg)
Java 虚拟机会将栈细分为面向 Java 方法的 Java 方法栈，面向本地方法（用 C++ 写的
native 方法）的本地方法栈，以及存放各个线程执行位置的 PC 寄存器。

在 HotSpot 里面，上述翻译过程有两种形式：
![](http://ww1.sinaimg.cn/large/b06adeeegy1g0jneuajf7j20n00bpmy0.jpg)
第一种是解释执行，即逐条将字节码翻译成机器码并执行；

第二种是即时编译（Just-In-Time compilation，JIT），即将一个方法中包含的所有字节码编
译成机器码后再执行。

总结：
之所以要在虚拟机中运行，是因为它提供了可移植性。一旦 Java 代码被编译为 Java 字节码，便可
以在不同平台上的 Java 虚拟机实现上运行。此外，虚拟机还提供了一个代码托管的环境，代替我们
处理部分冗长而且容易出错的事务，例如内存管理。
Java 虚拟机将运行时内存区域划分为五个部分，分别为方法区、堆、PC 寄存器、Java 方法栈和本
地方法栈。Java 程序编译而成的 class 文件，需要先加载至方法区中，方能在 Java 虚拟机中运行。
为了提高运行效率，标准 JDK 中的 HotSpot 虚拟机采用的是一种混合执行的策略。
它会解释执行 Java 字节码，然后会将其中反复执行的热点代码，以方法为单位进行即时编译，翻译
成机器码后直接运行在底层硬件之上。
HotSpot 装载了多个不同的即时编译器，以便在编译时间和生成代码的执行效率之间做取舍。